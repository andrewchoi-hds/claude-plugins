# TIL (Today I Learned)

---

## 2026-01-13

### 1. Claude Code 플러그인 시스템 제약

**발견**: Claude Code는 런타임 코드 실행 불가. JavaScript/Python으로 동적 로직 구현 불가.

**해결**: 프롬프트 기반 에이전트 설계. 마크다운 파일과 settings.json만으로 모든 기능 구현.

### 2. 언어 태그 패턴 (`[LANG: ko/en]`)

**방법**: 프롬프트에 `[LANG: ko]` 또는 `[LANG: en]` 태그 추가하여 에이전트 출력 언어 제어.

```markdown
프롬프트의 언어 태그에 따라 출력:
- `[LANG: ko]` → 한국어 출력
- `[LANG: en]` → English output
```

**효과**: 런타임 조건문 없이 다국어 지원.

### 3. 트리거 확장 전략 (24개 → 65개+)

한국어 트리거의 3가지 확장 축:

| 축 | 변형 예시 |
|---|----------|
| 띄어쓰기 | 세션정리 ↔ 세션 정리 |
| 어미 | 정리하자 / 정리할까 / 정리해줘 |
| 존댓말 | 해줘 ↔ 해주세요 |

**핵심**: 사용자 인지 부담 감소, 자연어 커버리지 증가.

### 4. 테이블 기반 출력 형식

**Before**:
```markdown
- [섹션]: [내용] — [이유]
```

**After**:
```markdown
| 항목 | 내용 |
|------|------|
| **추가할 내용** | [구체적인 내용] |
| **근거** | [세션에서 발견된 패턴] |
```

**효과**: 가독성 향상, 파싱 용이, 일관된 구조.

### 5. Phase 3 사용자 선택 완성

```
AskUserQuestion (multiSelect: true)
├── 커밋 생성
├── CLAUDE.md 업데이트
├── 자동화 생성
├── TIL.md 저장
└── TODO.md 저장
```

**핵심**: 사용자가 원하는 작업만 선택적으로 실행.

---

### 실수 → 수정

| 실수 | 해결 |
|------|------|
| 런타임 코드 실행 시도 | 프롬프트 기반 접근으로 전환 |
| 언어 감지 복잡한 로직 | `[LANG: tag]` 방식으로 단순화 |
| 트리거 7개만 추가 | 65개+로 확장 (변형 포함) |

---

## 2026-01-12

## Claude Code 플러그인 개발

### 1. 플러그인 디렉토리 구조

```
.claude/
├── agents/      # 에이전트 정의 (.md)
├── commands/    # 스킬/명령어 정의 (.md)
└── settings.json # 설정 (agents, skills, triggers)
```

**핵심**: `.claude/` 디렉토리가 플러그인의 루트. 파일만 만들면 안 되고 `settings.json`에 등록해야 작동함.

### 2. settings.json 이중 계층

```json
{
  "agents": {     // 에이전트 정의 (tools, description)
    "agent-name": {...}
  },
  "skills": {     // 트리거 정의 (triggers, description)
    "skill-name": {...}
  }
}
```

**핵심**: agents는 "무엇을 하는지", skills는 "언제 실행하는지" 분리.

### 3. 에이전트 Markdown 컨벤션

표준 섹션:
- `# [name] 에이전트` - 제목
- `## 목적` - 무엇을 하는지
- `## 출력 형식` - 구조화된 템플릿
- `## 사용 가능한 도구` - Read, Glob, Grep
- `## 지침` - 단계별 가이드
- `## 주의사항` - 제약사항

### 4. 한국어 트리거 확장

다양한 표현 방식 지원:
```json
"triggers": [
  "/wrap",           // 명령어
  "세션 정리",        // 기본
  "마무리해줘",       // 요청형
  "오늘은 여기까지",   // 대화형
  "랩"               // 축약
]
```

**핵심**: 사용자가 자연스럽게 말하는 모든 방식을 커버.

### 5. Phase 기반 에이전트 오케스트레이션

```
Phase 1: 병렬 실행 (독립 작업)
  ├── agent-1
  ├── agent-2
  └── agent-3

Phase 2: 순차 실행 (Phase 1 결과 필요)
  └── validator-agent

Phase 3: 사용자 인터랙션
  └── AskUserQuestion
```

**핵심**:
- 독립적 = 병렬 (효율성)
- 의존적 = 순차 (정확성)
- 최종 = 사용자 선택 (자율성)

---

## 효과적이었던 패턴

### 역할 분리
- 하나의 에이전트 = 하나의 책임
- 복잡한 작업 = 단순한 에이전트들의 조합

### 한/영 이중 언어
- description: 영어 + 한국어
- triggers: 두 언어 모두
- 출력: 한국어 우선

### 표준화된 명명
- kebab-case (doc-updater, automation-scout)
- 동사-명사 조합 (updater, extractor, checker)

---

## 피해야 할 것

1. **하나의 에이전트에 너무 많은 책임** → 역할 분리
2. **트리거 과도하게 추가** → 7-15개가 적당
3. **파일만 만들고 JSON 등록 안 함** → settings.json 확인 필수
